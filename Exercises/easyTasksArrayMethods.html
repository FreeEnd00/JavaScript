<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Metodi Array Js</title>
</head>
<body>
    <script>
        let _ = "!--!!--!!--!!--!!--!!--!!--!!--!"
        //Splice(start,deleteCount,element1,...,elementN)
        //elimina un elemento partendo dall'index 1 
        // let arraySplice = ["Pizza","Pasta","Mandolino"];
        // arraySplice.splice(1,1);
        // console.log(arraySplice);

        

        //rimuove i primi 3 elementi e li sostituisce con altri
        arraySplice = ["Pizza","Porro","Pompino","Mandolino"];
        console.log(arraySplice);
        // arraySplice.splice(0,3,"Pizza","Pasta");
        // console.log(arraySplice);
        console.log(_);


        //ritorna un array con gli elementi eliminati
        // let elementiRimossi = arraySplice.splice(0,3);
        // console.log(elementiRimossi);



        //aggiungi un elemento senza eliminare nulla
        arraySplice.splice(4,0,"Rutto","Lingotto","Pannolino");
        console.log(arraySplice);
        console.log(_);



        //aggiungi tramite numero negativo
        let arrayNeg = [1,5,6];
        arrayNeg.splice(-2,0,2,3,4);
        console.log(arrayNeg);
        console.log(_);



        //slice(start,end)
        let arraySlice = ["t","e","t","t","e"];
        console.log(arraySlice.slice(1,3));
        console.log(arraySlice.slice(-1));
        console.log(_);


        //concat(arg1,arg2)
        let arrConcat = [1,2];
        console.log(arrConcat.concat([3,4]));
        console.log(arrConcat.concat([3,4],[5,6]));
        console.log(_);


        //concat con oggetti js
        let quasiArray = {
            0:"Pene",
            length:1
        };
        console.log(arrConcat.concat(quasiArray));
        let arrayLike = {
            0: "Pino",
            1: "Cane",
            [Symbol.isConcatSpreadable]: true,
            length:2
        };
        console.log(arrConcat.concat(arrayLike));
        console.log(_);



        //forEach(function(item,index,array))
        ["Basso","Chitarra","Ukulele","Violino"].forEach(console.log);

        ["Basso","Chitarra","Ukulele","Violino"].forEach((item,index,array) => {
            console.log(`${item} is at index ${index} in ${array}`);
        });



        //indexOf()
        let arrIndexOf = [1,0,true];
        console.log(arrIndexOf.indexOf(0)); //1
        console.log(arrIndexOf.indexOf(true)); //2
        console.log(arrIndexOf.indexOf(null)); //-1

        //includes()
        console.log(arrIndexOf.includes(1) ); //true

        //lastIndexOf()
        let frutti = ["Mela","Pera","Mela"];
        console.log(frutti.indexOf("Mela"));//0
        console.log(frutti.lastIndexOf("Mela")); //2


        //NaN includes()
        let arr = [NaN];
        console.log(arr.indexOf(NaN)); //-1 sbagliato, dovrebbe essere 0
        console.log(arr.includes(NaN)); //true


        //let result = arr.find(function(item, index, array){
        //})

        let users = [
            {id: 1, name: "Jhon"},
            {id: 2, name: "Robert"},
            {id: 3, name: "Jeff"},
            {id: 4, name: "Jhon"}
        ];

        let user = users.find(item => item.id == 1);

        console.log(user.name); //Jhon

        //findIndex() and findLastIndex()
        console.log(users.findIndex(user => user.name == "Jhon")); //0
        console.log(users.findLastIndex(user => user.name == "Jhon")) //3

        

        //filter()
        let someUsers = users.filter(item => item.id < 3);
        console.log(someUsers.length);


        //map()

        let lenghts = ["Frodo","Gandalf","Gollum"].map(item => item.length);
        console.log(lenghts); //5,7,6



        //sort()
        let arrToSort = [18,14,3];
        // console.log(arrToSort.sort());
        
        // function compareNumeric(a,b){
        //     if (a > b) return 1;
        //     if(a == b) return 0;
        //     if(a < b) return -1;
        // };
        // console.log(arrToSort.sort(compareNumeric));

        [1,-2,15,2,0,8].sort(function(a,b){
            console.log(a + "<>" + b);
            return a - b;
        });

        // arrToSort.sort(function(a,b){return a - b;});
        // console.log(arrToSort);


        arrToSort.sort((a,b)=> a-b);
        console.log(arrToSort);

        let countries = ['Ã–sterreich', 'Andorra', 'Vietnam'];
        console.log(countries.sort((a,b) => a > b ? 1 : -1));
        console.log(countries.sort((a,b) => a.localeCompare(b)));


        //reverse()
        let reverseArray = [10,9,8,7,6,5,4,3,2,1,0];
        console.log(reverseArray.reverse());


        //split() & join()
        let names = "Carlotta,Thomas,Michele,Esmeralda,Martina,Aurora,Angela,Juergen,Umberto"
        let arrNames = names.split(",");
        for ( let name of arrNames){
            console.log(`Un messaggio da ${name}`);
        }
        let splitTwoNames = names.split(",",2);
        console.log(splitTwoNames);

        //split() letters
        let letters = names.split("");
        console.log(letters);


        //join()
        console.log(letters.join(""));



        //reduce()/reduceRight() 
        //let value = arr.reduce(function(accumulator, item, index, array) {
         // ...
        // }, [initial]);

        let numeri = [1,2,3,4,5,6,7,8,9,10];
        // let somma = numeri.reduce((summ,current) => summ + current, 0);
        let somma = numeri.reduce((summ,current) => summ + current);
        console.log(somma);


        //Array.isArray()
        console.log(Array.isArray({})); //false
        console.log(Array.isArray([])); //true


        //thisArg


        let army = {
            minAge: 18,
            maxAge: 27,
            canJoin(user){
                return user.age >= this.minAge && user.age < this.maxAge;
            }
        };
        let utenti = [
            {age:16},
            {age:20},
            {age:23},
            {age: 30}
        ];

        let soldiers = utenti.filter(army.canJoin,army);
        console.log(soldiers.length);
        console.log(soldiers[0].age);
        console.log(soldiers[1].age);

        //esercizi


        //camelize(str)

        function camelize(str){
           return str
           .split("-")
           .map(
            (word,index) => index == 0 ? word : word[0].toUpperCase() + word.slice(1)
           )
           .join("");
        }

        console.log(camelize("background-color"));
        console.log(camelize("list-style-image"));
        console.log(camelize("-webkit-transition"));


        //filterRange()

        function filterRange(arr, a, b){
            return arr.filter(item => (a <= item && item <= b));
        }

        let arrayNotFiltered = [5,3,8,1];
        let filtered = filterRange(arrayNotFiltered,1,4);
        console.log(filtered);
        console.log(arrayNotFiltered);


        //filterRangeInPlace()

        function filterRangeInPlace(arr,a,b){
            for(let i = 0; i < arr.length; i++){
                let val = arr[i];
                if(val < a || val > b){
                    arr.splice(i,1);
                    i--;
                }
            }
        };

        let array = [5,3,8,1];
        filterRangeInPlace(array,1,4);
        console.log(array);


        //sort in decreasing order

        let arrayDisordinato = [5,2,1,-10,8];
        arrayDisordinato.sort((a,b) => a-b);
        console.log(arrayDisordinato)
        arrayDisordinato.reverse();
        console.log(arrayDisordinato)



        //copy and sort array

        function copySorted(arr){
            return arr.slice().sort();
        }

        let arrayStr = ["HTML","Javascript","CSS"];
        let sorted = copySorted(arrayStr);
        console.log(sorted);
        console.log(arrayStr);



        //Calculator


        function Calculator(){
            this.methods = {
                "-": (a,b) => a - b,
                "+": (a,b) => a + b
            };
            
            this.calculate = function(str){
                let split = str.split(" "),
                    a = +split[0],
                    op = split[1],
                    b = +split[2];
                
                if (!this.methods[op] || isNaN(a) || isNaN(b)){
                    return NaN;
                }    

                return this.methods[op](a,b);
            };

            this.addMethod = function(name, func){
                this.methods[name] = func;
            };
        }

        let calc = new Calculator;
        console.log(calc.calculate("3 + 7"));

        let powerCalc = new Calculator;
        powerCalc.addMethod("*",(a,b)=> a * b);
        powerCalc.addMethod("/",(a,b)=> a / b);
        powerCalc.addMethod("**", (a,b)=> a ** b);

        let result = powerCalc.calculate("2 ** 3");
        console.log(result);




        //map to names

        let john = {nome: "John", age: 25};
        let pete = {nome: "Pete", age: 22};
        let mary = {nome: "Mary", age: 30};

        let usersToMap = [john,pete,mary];

        let nomi = usersToMap.map(item => item.nome);

        console.log(nomi);


        //map to objects

        let carlotta = {nome: "Carlotta", cognome: "Marcialis", id:1};
        let thomas = {nome: "Thomas", cognome: "Ginder", id:2};
        let aurora = {nome: "Aurora", cognome: "Ginder", id:3};

        let utentiReali = [carlotta,thomas,aurora];

            let utentiMappati = utentiReali.map(utente => ({
                fullName: `${utente.nome} ${utente.cognome}`,
                id: utente.id,
            }));

        console.log(utentiMappati);
        console.log(utentiMappati[0].id);
        console.log(utentiMappati[0].fullName);



        //sort users by age
        function sortByAge(array){
            array.sort((a,b) => a.eta - b.eta);
        }
        let michele = {nome: "Michele", eta: 25};
        let marta = {nome: "Marta", eta: 22};
        let cristian = {nome: "Cristian", eta: 17};

        let cugini = [michele,marta,cristian];

        sortByAge(cugini);
        console.log(cugini[0].nome);
        console.log(cugini[1].nome);
        console.log(cugini[2].nome);


        //Shuffle()

        // function shuffle(array){
        //     array.sort(() => Math.random() - 0.5);
        // }

        // let arrayDaRandomizzare = [1,2,3,4,5,6,7,8,9,0];
        // shuffle(arrayDaRandomizzare);
        // console.log(arrayDaRandomizzare);
        

   

        function shuffle(array){
            for(let i = array.length - 1; i > 0; i--){
                let j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }
        let count = {
        '123': 0,
        '132': 0,
        '213': 0,
        '231': 0,
        '321': 0,
        '312': 0
        };
        for(let i = 0; i < 1000000; i ++){
            let array = [1,2,3];
            shuffle(array);
            count[array.join("")]++;
        }

        for(let key in count){
            console.log(`${key}: ${count[key]}`);
        }



        //getAvarangeAge()


        function getAvarangeAge(users){
            return users.reduce((prev,user) => prev + user.eta, 0) / users.length;
        }

        let mamma = {nome: "Angela", eta: 60};
        let papa = {nome: "Juergen", eta: 55};
        let anonimo = {nome: "Sconosciuto", eta: 53};

        let usersGenitori = [mamma,papa,anonimo];

        console.log(getAvarangeAge(usersGenitori));     



        //unique()


        function unique(arr){
            let result = [];

            for(let str of arr){
                if(!result.includes(str)){
                    result.push(str);
                }
            }
            return result;
        }

        let strings = ["Ano", "Balena", "Salame", "Castoro", "Ano", "Salame", "Cerbiatto", "Istrice", "Istrice","Lavoro"];

        console.log(unique(strings));



        //groupById()


        function groupById(arr){
            return arr.reduce((obj,value) => {
                obj[value.id] = value;
                return obj;
            },{})
        }

        let utentiID = [
            {id: "gimmy", nome: "Gimmy Smith", eta: 29},
            {id: "rose", nome: "Rose Nelson", eta: 24},
            {id: "peter", nome: "Peter Jackson", eta: 34},
        ];

        let utentiDaId = groupById(utentiID);

        console.log(utentiDaId);
    </script>
</body>
</html>